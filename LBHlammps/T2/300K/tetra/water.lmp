#LAMMPS Input file generated by Avogadro
# water

# Intialization
units          real
dimension      3
boundary       p p p
atom_style     full
newton         on
read_data      water64.data  ## "enter your data file name"


#The TIP4P/ICE water potential  
#===========================================
# modify it to TIP4P/ICE potential
pair_style      lj/cut/tip4p/long  1 2 1 1 0.1546 8.5 10.0 #pair_style cannot write twice but can use hybrid code
pair_coeff      1 1 0.1852 3.1589 8.5   #this parameter can get from manual or paper
pair_coeff      * 2 0.00000 0.0000 8.5

bond_style      harmonic
bond_coeff      1  0   0.9572
angle_style     harmonic
angle_coeff     1  0  104.52

kspace_style    pppm/tip4p 0.0001


neighbor       2.0 bin
neigh_modify   every 1 delay 0 check yes

mass            1       15.999400
mass            2        1.008000


#dihedral_style  none
#improper_style  none

fix             fixShake  all shake 0.0001 20 0 b 1 a 1
# modify it to TIP4P/ICE potential
#===========================================

# Settings
velocity       all create 300.00 300 rot yes mom yes dist gaussian
fix            ensemble all nvt temp 300.00 300.00 100 


compute rd1 all rdf 100 1 1  #rdf       
fix OO all ave/time 1000 1 1000 c_rd1[1] c_rd1[2] c_rd1[3] file rdf.OO mode vector 

compute rd2 all rdf 100 1 2  #rdf      
fix OH all ave/time 1000 1 1000  c_rd2[1] c_rd2[2] c_rd2[3] file rdf.OH mode vector 

compute msd all msd com yes   #计算MSD
fix savemsd all ave/time 1000 1 1000 c_msd[1] c_msd[2] c_msd[3] c_msd[4] file msd.data mode scalar

compute 1 all orientorder/atom degrees 4
dump 1 all custom 1000 tetra.ori id c_1[0] 
timestep       1.0

# Output

thermo         2000
thermo_style   custom step temp pe etotal press vol
thermo_modify  flush yes

dump         water  all  custom 2000   test.lammpstrj id mol type x y z xu yu zu 

# Run the simulation
run            500000
write_data   system_after_nvt.data
